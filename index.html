<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Ninja Clan RPG (Rebuild v1 â€” UI Skeleton)</title>

<style>
  html,body{
    margin:0;width:100%;height:100%;overflow:hidden;background:#0f0f12;
    font-family:system-ui,-apple-system,Segoe UI,Roboto;
    touch-action:manipulation;-webkit-user-select:none;user-select:none
  }
  :root{
    --pad-top: env(safe-area-inset-top);
    --pad-right: env(safe-area-inset-right);
    --pad-bottom: env(safe-area-inset-bottom);
    --pad-left: env(safe-area-inset-left);
    --wood1:#a56a3c; --wood2:#7a4b2a; --ink:#22140b; --accent:#ff7a18;
  }
  *{-webkit-tap-highlight-color:transparent}
  .hidden{display:none!important}

  /* ===== Top bar ===== */
  #topbar{
    position:absolute; z-index:50;
    left:calc(10px + var(--pad-left));
    right:calc(10px + var(--pad-right));
    top:calc(10px + var(--pad-top));
    display:flex;gap:8px;align-items:center;justify-content:space-between;
    background:linear-gradient(var(--wood1),var(--wood2));
    border:2px solid rgba(0,0,0,.18);
    border-radius:14px;
    padding:8px 10px;
    box-shadow:0 10px 24px rgba(0,0,0,.25);
    color:var(--ink);
  }
  .barL,.barR{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .chip{
    display:flex;gap:6px;align-items:center;
    background:rgba(255,255,255,.22);
    border:1px solid rgba(0,0,0,.14);
    border-radius:999px;
    padding:5px 8px;
    font-weight:950;
    font-size:11px;
    line-height:1;
  }
  .chip b{font-family:ui-monospace,Menlo,monospace}
  .btn{
    border:0;border-radius:12px;padding:9px 10px;font-weight:950;
    background:#eee;color:#111; box-shadow:0 6px 14px rgba(0,0,0,.18);
    font-size:12px;
  }
  .btn.primary{background:var(--accent)}
  .btn.ghost{background:rgba(255,255,255,.25); border:1px solid rgba(0,0,0,.14);}
  .btn.small{padding:7px 9px;font-size:11px;border-radius:11px}

  /* ===== Town ===== */
  #town{ position:absolute; inset:0; padding-top:calc(56px + var(--pad-top)); }
  #townLayer{ position:absolute; inset:0; transform: translateY(95px); }
  #townBg{
    position:absolute; inset:0;
    background-image:url("town.jpg");
    background-size:cover;
    background-position:center top;
    background-repeat:no-repeat;
  }
  .hotspot{
    position:absolute;
    background:transparent;
    border:0;
    border-radius:18px;
    padding:0;
    z-index:10;
    touch-action:manipulation;
  }
  .label{
    position:absolute;
    left:50%;
    bottom:10%;
    transform:translateX(-50%);
    padding:8px 12px;
    border-radius:999px;
    background:rgba(255,255,255,.78);
    border:1px solid rgba(0,0,0,.15);
    font-weight:1000;
    font-size:14px;
    color:#111;
    box-shadow:0 8px 20px rgba(0,0,0,.18);
    pointer-events:none;
    white-space:nowrap;
  }

  /* Hotspots tuned for your town image style */
  #hsHospital { left:  2%; top: 11%; width: 38%; height: 22%; }
  #hsDojo     { left: 66%; top: 10%; width: 32%; height: 26%; }
  #hsDaimyo   { left: 33%; top: 26%; width: 36%; height: 22%; }
  #hsRelic    { left:  4%; top: 40%; width: 32%; height: 20%; }
  #hsWeapon   { left: 62%; top: 33%; width: 34%; height: 22%; }
  #hsRecruit  { left:  6%; top: 60%; width: 36%; height: 22%; }
  #hsFight    { left: 49%; top: 51%; width: 47%; height: 22%; }

  /* ===== Modals ===== */
  .modal{
    position:absolute; inset:0; z-index:80;
    display:flex; align-items:center; justify-content:center;
    background:rgba(0,0,0,.35);
    padding:14px;
  }
  .card{
    width:min(720px,96%);
    background:linear-gradient(#f7edd6,#f0e0bf);
    border:2px solid rgba(0,0,0,.18);
    border-radius:18px;
    padding:14px;
    box-shadow:0 20px 50px rgba(0,0,0,.28);
    color:#23140b;
  }
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .sp{justify-content:space-between}
  .title{margin:0;font-size:16px;font-weight:1000}
  .muted{opacity:.78;font-size:12px;line-height:1.25}
  .list{
    margin-top:10px;
    max-height:320px; overflow:auto;
    border-radius:14px;
    border:1px solid rgba(0,0,0,.14);
    background:rgba(255,255,255,.22);
  }
  .item{
    display:flex;align-items:center;justify-content:space-between;gap:10px;
    padding:10px 12px;border-bottom:1px solid rgba(0,0,0,.10);
    font-size:12px;
  }
  .item:last-child{border-bottom:0}
  .pill{
    display:inline-block;
    padding:4px 8px;border-radius:999px;
    background:rgba(255,255,255,.55);
    border:1px solid rgba(0,0,0,.10);
    font-size:11px;font-weight:950;
  }

  /* Tabs */
  .tabs{display:flex;gap:8px;margin-top:8px}
  .tab{
    padding:8px 10px;border-radius:999px;font-weight:1000;font-size:12px;
    border:1px solid rgba(0,0,0,.14);
    background:rgba(255,255,255,.35);
  }
  .tab.active{background:rgba(255,255,255,.65)}
  .tabPane{margin-top:10px}

  /* Dojo preview */
  #dojoPreviewWrap{
    display:flex;gap:12px;align-items:center;flex-wrap:wrap;
    background:rgba(255,255,255,.22);
    border:1px solid rgba(0,0,0,.12);
    border-radius:14px;
    padding:10px 12px;
    margin-top:10px;
  }
  #dojoCanvas{
    width:120px;height:120px;
    border-radius:14px;
    border:1px solid rgba(0,0,0,.12);
    background:rgba(0,0,0,.08);
  }

  /* ===== Battle (screen only; engine comes in Step 3) ===== */
  #battle{ position:absolute; inset:0; z-index:60; }
  #battleBg{
    position:absolute; inset:0;
    background-image:url("battle.jpg");
    background-size:cover;
    background-position:center;
    background-repeat:no-repeat;
    transform:scale(1.02);
  }
  #battleCanvas{position:absolute; inset:0; width:100%; height:100%}
  #battleTop{
    position:absolute; z-index:70;
    left:calc(10px + var(--pad-left));
    right:calc(10px + var(--pad-right));
    top:calc(10px + var(--pad-top));
    display:flex;gap:10px;align-items:center;justify-content:space-between;
  }
  .hpBox{
    flex:1 1 0;
    background:linear-gradient(var(--wood1),var(--wood2));
    border:2px solid rgba(0,0,0,.18);
    border-radius:14px;
    padding:10px 12px;
    box-shadow:0 10px 24px rgba(0,0,0,.22);
    color:var(--ink);
    min-width:0;
  }
  .hpName{font-weight:1000;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .hpBar{height:12px;border-radius:999px;background:rgba(0,0,0,.18);overflow:hidden;margin-top:6px;border:1px solid rgba(0,0,0,.12);}
  .hpFill{height:100%; width:70%; background:linear-gradient(#ffb845,#ff7a18);}
  .vs{font-weight:1000;font-size:22px;color:#fff;text-shadow:0 4px 10px rgba(0,0,0,.35);padding:0 10px}
  #battleBackBtn{
    position:absolute; z-index:70;
    top:calc(78px + var(--pad-top));
    left:50%; transform:translateX(-50%);
    background:rgba(255,255,255,.8);
    border:2px solid rgba(0,0,0,.18);
    border-radius:12px; padding:10px 14px; font-weight:1000;
  }
</style>
</head>

<body>
  <div id="topbar">
    <div class="barL">
      <div class="chip">Rebuild <b>UI-SKELETON</b></div>
      <div class="chip">Active <b id="uiName">Starter Ninja</b></div>
      <div class="chip">HP <b id="uiHP">60/60</b></div>
      <div class="chip">TP <b id="uiTP">10</b></div>
      <div class="chip">Belt <b id="uiBelt">White</b></div>
      <div class="chip">ðŸª™ <b id="uiGold">200</b></div>
      <div class="chip">â˜¯ <b id="uiKarma">50</b></div>
    </div>
    <div class="barR">
      <button class="btn ghost small" id="dailyBtn">Meditate</button>
      <button class="btn ghost small" id="profilesBtn">Profiles</button>
      <button class="btn ghost small" id="saveBtn">Save</button>
      <button class="btn ghost small" id="resetBtn">Reset</button>
    </div>
  </div>

  <!-- Town -->
  <div id="town">
    <div id="townLayer">
      <div id="townBg"></div>

      <button class="hotspot" id="hsHospital"><div class="label">Hospital</div></button>
      <button class="hotspot" id="hsDojo"><div class="label">Dojo</div></button>
      <button class="hotspot" id="hsDaimyo"><div class="label">Daimyo</div></button>
      <button class="hotspot" id="hsRelic"><div class="label">Relic Shop</div></button>
      <button class="hotspot" id="hsWeapon"><div class="label">Weapon Shop</div></button>
      <button class="hotspot" id="hsRecruit"><div class="label">Recruit</div></button>
      <button class="hotspot" id="hsFight"><div class="label">Battle</div></button>
    </div>
  </div>

  <!-- Battle (placeholder view for now; Step 3 will implement engine) -->
  <div id="battle" class="hidden">
    <div id="battleBg"></div>
    <canvas id="battleCanvas"></canvas>

    <div id="battleTop">
      <div class="hpBox">
        <div class="hpName" id="pName">You</div>
        <div class="hpBar"><div class="hpFill" id="pHPFill"></div></div>
      </div>
      <div class="vs">VS</div>
      <div class="hpBox">
        <div class="hpName" id="eName">Enemy</div>
        <div class="hpBar"><div class="hpFill" id="eHPFill"></div></div>
      </div>
    </div>

    <button id="battleBackBtn" class="btn">BACK</button>
  </div>

  <!-- Dojo Modal -->
  <div class="modal hidden" id="dojoModal">
    <div class="card">
      <div class="row sp">
        <h3 class="title">Dojo</h3>
        <button class="btn ghost small" id="closeDojo">Close</button>
      </div>

      <div class="tabs">
        <button class="tab active" id="tabTrain">Training</button>
        <button class="tab" id="tabNinja">Ninja</button>
      </div>

      <!-- Training tab -->
      <div class="tabPane" id="paneTrain">
        <div class="muted">Spend TP to train STR / AGI / END. (Soft caps + belt/level come in Step 2.)</div>

        <div class="row" style="margin-top:10px">
          <div class="chip">STR <b id="stSTR">1</b></div>
          <div class="chip">AGI <b id="stAGI">1</b></div>
          <div class="chip">END <b id="stEND">1</b></div>
          <div class="chip">TP <b id="tpHere">10</b></div>
        </div>

        <div class="row" style="margin-top:10px">
          <button class="btn primary" id="trainSTR">+ STR</button>
          <button class="btn primary" id="trainAGI">+ AGI</button>
          <button class="btn primary" id="trainEND">+ END</button>
        </div>
      </div>

      <!-- Ninja tab -->
      <div class="tabPane hidden" id="paneNinja">
        <div class="muted">Current ninja, stats, and equipment (full inventory/equip comes in Step 2).</div>

        <div id="dojoPreviewWrap">
          <canvas id="dojoCanvas" width="120" height="120"></canvas>
          <div style="min-width:200px;flex:1">
            <div style="font-weight:1000;font-size:14px" id="djName">Starter Ninja</div>
            <div class="muted" id="djLine">HP 60/60 â€¢ TP 10</div>
            <div class="muted" id="djBelt">Belt: White</div>
            <div class="muted" id="djEquip">Equipped: None</div>
          </div>
        </div>

        <div class="list" style="margin-top:10px">
          <div class="item"><div><b>Weapon</b><div class="muted">Equip from Weapon Shop</div></div><span class="pill" id="djWeapon">None</span></div>
          <div class="item"><div><b>Relic</b><div class="muted">Equip from Relic Shop</div></div><span class="pill" id="djRelic">None</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recruit Modal -->
  <div class="modal hidden" id="recruitModal">
    <div class="card">
      <div class="row sp">
        <h3 class="title">Recruit</h3>
        <button class="btn ghost small" id="closeRecruit">Close</button>
      </div>
      <div class="muted">Roster list + set active will be wired in Step 2. This is UI skeleton.</div>
      <div class="row" style="margin-top:10px">
        <button class="btn primary" id="recruitBtn">Recruit</button>
        <button class="btn ghost" id="setActiveBtn">Set Active</button>
      </div>
      <div class="list" id="rosterList"></div>
    </div>
  </div>

  <!-- Weapon Shop Modal -->
  <div class="modal hidden" id="weaponModal">
    <div class="card">
      <div class="row sp">
        <h3 class="title">Weapon Shop</h3>
        <button class="btn ghost small" id="closeWeapon">Close</button>
      </div>
      <div class="muted">Full shop list + buy/equip logic comes in Step 2. UI skeleton.</div>
      <div class="row" style="margin-top:10px">
        <button class="btn ghost" id="buyWeaponBtn">Buy</button>
        <button class="btn primary" id="equipWeaponBtn">Equip</button>
        <button class="btn ghost" id="refreshWeaponBtn">Refresh</button>
      </div>
      <div class="list" id="weaponList"></div>
    </div>
  </div>

  <!-- Relic Shop Modal -->
  <div class="modal hidden" id="relicModal">
    <div class="card">
      <div class="row sp">
        <h3 class="title">Relic Shop</h3>
        <button class="btn ghost small" id="closeRelic">Close</button>
      </div>
      <div class="muted">Full shop list + buy/equip logic comes in Step 2. UI skeleton.</div>
      <div class="row" style="margin-top:10px">
        <button class="btn ghost" id="buyRelicBtn">Buy</button>
        <button class="btn primary" id="equipRelicBtn">Equip</button>
        <button class="btn ghost" id="refreshRelicBtn">Refresh</button>
      </div>
      <div class="list" id="relicList"></div>
    </div>
  </div>

  <!-- Daimyo Modal -->
  <div class="modal hidden" id="daiModal">
    <div class="card">
      <div class="row sp">
        <h3 class="title">Daimyo</h3>
        <button class="btn ghost small" id="closeDai">Close</button>
      </div>
      <div class="muted">Progression overview (belt thresholds + wins/losses UI comes in Step 2).</div>
      <div class="list" style="margin-top:10px">
        <div class="item"><div><b>Belts</b><div class="muted">White â†’ Black</div></div><span class="pill">TP-based</span></div>
        <div class="item"><div><b>Clan</b><div class="muted">Your ninja roster</div></div><span class="pill" id="dClan">1 ninja</span></div>
      </div>
    </div>
  </div>

  <!-- Battle Select Modal -->
  <div class="modal hidden" id="battleSelectModal">
    <div class="card">
      <div class="row sp">
        <h3 class="title">Choose Battle</h3>
        <button class="btn ghost small" id="closeBattleSelect">Close</button>
      </div>
      <div class="muted">This is the selection UI. Step 3 adds real battles + animations.</div>
      <div class="list" id="battleList"></div>
    </div>
  </div>

  <!-- Profiles Modal -->
  <div class="modal hidden" id="profilesModal">
    <div class="card">
      <div class="row sp">
        <h3 class="title">Profiles</h3>
        <button class="btn ghost small" id="closeProfiles">Close</button>
      </div>
      <div class="muted">Save slots UI. Step 2 wires real switching + metadata.</div>
      <div class="list" id="profilesList"></div>
    </div>
  </div>

<script>
/* ======================================================
   STEP 1 â€” UI SKELETON ONLY
   Goal: Everything clickable, modals open/close, no errors.
====================================================== */

const SAVE_KEY = "ninja_rebuild_ui_skeleton_v1";

function $(id){ return document.getElementById(id); }

function defaultState(){
  return {
    currency:{gold:200, karma:50},
    ninjas:[{
      id:"n1",
      name:"Starter Ninja",
      hp:60,maxHP:60,tp:10,
      base:{str:1,agi:1,end:1},
      equip:{weapon:null,relic:null}
    }],
    activeId:"n1",
    shop:{weapons:[], relics:[]},
    rosterSelectedId:"n1"
  };
}

let state = load();
function load(){
  try{
    const raw = localStorage.getItem(SAVE_KEY);
    if(!raw) return defaultState();
    const s = JSON.parse(raw);
    return s?.ninjas?.length ? s : defaultState();
  }catch{
    return defaultState();
  }
}
function persist(){ localStorage.setItem(SAVE_KEY, JSON.stringify(state)); }

function activeNinja(){
  return state.ninjas.find(n=>n.id===state.activeId) || state.ninjas[0];
}

/* ---------- Modal helpers ---------- */
function openModal(id){ $(id).classList.remove("hidden"); }
function closeModal(id){ $(id).classList.add("hidden"); }

/* ---------- Tabs ---------- */
function setDojoTab(which){
  $("tabTrain").classList.toggle("active", which==="train");
  $("tabNinja").classList.toggle("active", which==="ninja");
  $("paneTrain").classList.toggle("hidden", which!=="train");
  $("paneNinja").classList.toggle("hidden", which!=="ninja");
  refreshDojo();
}
$("tabTrain").onclick=()=>setDojoTab("train");
$("tabNinja").onclick=()=>setDojoTab("ninja");

/* ---------- Simple preview draw (placeholder) ---------- */
function roundRect(ctx,x,y,w,h,r){
  const rr=Math.min(r,w/2,h/2);
  ctx.beginPath();
  ctx.moveTo(x+rr,y);
  ctx.arcTo(x+w,y, x+w,y+h, rr);
  ctx.arcTo(x+w,y+h, x,y+h, rr);
  ctx.arcTo(x,y+h, x,y, rr);
  ctx.arcTo(x,y, x+w,y, rr);
  ctx.closePath();
  ctx.fill();
}
function drawPreview(){
  const c=$("dojoCanvas");
  const ctx=c.getContext("2d");
  ctx.clearRect(0,0,c.width,c.height);
  const n=activeNinja();

  // body
  ctx.fillStyle="#111";
  roundRect(ctx,42,44,36,42,12);

  // head
  ctx.beginPath(); ctx.arc(60,30,16,0,Math.PI*2); ctx.fill();

  // belt
  ctx.fillStyle="#f5f5f5";
  roundRect(ctx,42,64,36,8,4);

  // arms placeholder
  ctx.strokeStyle="#111"; ctx.lineWidth=6; ctx.lineCap="round";
  ctx.beginPath(); ctx.moveTo(44,56); ctx.lineTo(28,70); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(76,56); ctx.lineTo(92,70); ctx.stroke();

  // small weapon hint
  ctx.strokeStyle="rgba(255,255,255,.6)"; ctx.lineWidth=3;
  ctx.beginPath(); ctx.moveTo(92,70); ctx.lineTo(110,52); ctx.stroke();

  // name
  ctx.fillStyle="rgba(255,255,255,.85)";
  ctx.font="900 10px system-ui";
  ctx.fillText(n.name.slice(0,10), 10, 115);
}

/* ---------- UI refresh ---------- */
function refreshTop(){
  const n=activeNinja();
  $("uiName").textContent = n.name;
  $("uiHP").textContent = `${n.hp}/${n.maxHP}`;
  $("uiTP").textContent = n.tp;
  $("uiBelt").textContent = "White";
  $("uiGold").textContent = state.currency.gold;
  $("uiKarma").textContent = state.currency.karma;
}
function refreshDojo(){
  const n=activeNinja();
  $("stSTR").textContent=n.base.str;
  $("stAGI").textContent=n.base.agi;
  $("stEND").textContent=n.base.end;
  $("tpHere").textContent=n.tp;

  $("djName").textContent=n.name;
  $("djLine").textContent=`HP ${n.hp}/${n.maxHP} â€¢ TP ${n.tp}`;
  $("djBelt").textContent=`Belt: White`;
  $("djEquip").textContent=`Equipped: None`;
  $("djWeapon").textContent=n.equip.weapon ? n.equip.weapon.name : "None";
  $("djRelic").textContent=n.equip.relic ? n.equip.relic.name : "None";

  drawPreview();
}
function refreshRoster(){
  const list=$("rosterList");
  list.innerHTML="";
  state.ninjas.forEach(n=>{
    const row=document.createElement("div");
    row.className="item";
    row.style.background = (n.id===state.rosterSelectedId) ? "rgba(255,255,255,.35)" : "";
    row.innerHTML=`
      <div style="min-width:0">
        <div style="font-weight:1000;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">
          ${n.name} ${n.id===state.activeId ? `<span class="pill">ACTIVE</span>`:""}
        </div>
        <div class="muted">STR ${n.base.str} â€¢ AGI ${n.base.agi} â€¢ END ${n.base.end} â€¢ TP ${n.tp}</div>
      </div>
      <button class="btn ghost small">Select</button>
    `;
    row.querySelector("button").onclick=()=>{ state.rosterSelectedId=n.id; persist(); refreshRoster(); };
    list.appendChild(row);
  });
}
function refreshProfiles(){
  const list=$("profilesList");
  list.innerHTML="";
  const row=document.createElement("div");
  row.className="item";
  row.innerHTML=`<div><b>Slot 1</b><div class="muted">UI skeleton only</div></div><span class="pill">ACTIVE</span>`;
  list.appendChild(row);
}
function refreshBattleList(){
  const list=$("battleList");
  list.innerHTML="";
  const makeRow=(name,desc)=>{
    const row=document.createElement("div");
    row.className="item";
    row.innerHTML=`<div><b>${name}</b><div class="muted">${desc}</div></div><button class="btn primary">Select</button>`;
    row.querySelector("button").onclick=()=>{
      closeModal("battleSelectModal");
      showBattle(true); // placeholder view only
    };
    list.appendChild(row);
  };
  makeRow("Enemy Clan (Easy)", "1â€“2 ninjas â€¢ placeholder");
  makeRow("Enemy Clan (Hard)", "3â€“4 ninjas â€¢ placeholder");
  makeRow("Black Belt Boss", "Grandmaster â€¢ placeholder");
}

/* ---------- Town actions ---------- */
$("hsHospital").onclick=()=>{
  const n=activeNinja();
  n.hp=n.maxHP;
  persist(); refreshTop(); refreshDojo();
  openModal("daiModal"); // quick feedback for now
  $("dClan").textContent = `${state.ninjas.length} ninja${state.ninjas.length===1?"":"s"}`;
};
$("hsDojo").onclick=()=>{
  setDojoTab("train");
  refreshDojo();
  openModal("dojoModal");
};
$("hsDaimyo").onclick=()=>{
  $("dClan").textContent = `${state.ninjas.length} ninja${state.ninjas.length===1?"":"s"}`;
  openModal("daiModal");
};
$("hsRelic").onclick=()=>{ openModal("relicModal"); };
$("hsWeapon").onclick=()=>{ openModal("weaponModal"); };
$("hsRecruit").onclick=()=>{
  refreshRoster();
  openModal("recruitModal");
};
$("hsFight").onclick=()=>{
  refreshBattleList();
  openModal("battleSelectModal");
};

/* ---------- Close buttons ---------- */
$("closeDojo").onclick=()=>closeModal("dojoModal");
$("closeRecruit").onclick=()=>closeModal("recruitModal");
$("closeWeapon").onclick=()=>closeModal("weaponModal");
$("closeRelic").onclick=()=>closeModal("relicModal");
$("closeDai").onclick=()=>closeModal("daiModal");
$("closeBattleSelect").onclick=()=>closeModal("battleSelectModal");
$("profilesBtn").onclick=()=>{ refreshProfiles(); openModal("profilesModal"); };
$("closeProfiles").onclick=()=>closeModal("profilesModal");

/* ---------- Battle screen placeholder controls ---------- */
function showBattle(v){
  $("battle").classList.toggle("hidden", !v);
  $("town").classList.toggle("hidden", v);
}
$("battleBackBtn").onclick=()=>showBattle(false);

/* ---------- Buttons that will be wired in Step 2 ---------- */
$("trainSTR").onclick=()=>{ const n=activeNinja(); if(n.tp<=0) return; n.tp--; n.base.str++; persist(); refreshTop(); refreshDojo(); };
$("trainAGI").onclick=()=>{ const n=activeNinja(); if(n.tp<=0) return; n.tp--; n.base.agi++; persist(); refreshTop(); refreshDojo(); };
$("trainEND").onclick=()=>{ const n=activeNinja(); if(n.tp<=0) return; n.tp--; n.base.end++; persist(); refreshTop(); refreshDojo(); };

$("recruitBtn").onclick=()=>{
  // placeholder recruit
  const id="n"+(state.ninjas.length+1);
  state.ninjas.push({id,name:`Clan Ninja ${state.ninjas.length}`,hp:60,maxHP:60,tp:0,base:{str:1,agi:1,end:1},equip:{weapon:null,relic:null}});
  state.rosterSelectedId=id;
  persist(); refreshTop(); refreshRoster();
};
$("setActiveBtn").onclick=()=>{
  if(!state.rosterSelectedId) return;
  state.activeId=state.rosterSelectedId;
  persist(); refreshTop(); refreshDojo(); refreshRoster();
};

/* Shop placeholders (Step 2 will be real lists) */
$("buyWeaponBtn").onclick=()=>alert("Step 2 will restore full Weapon Shop list + buy/equip.");
$("equipWeaponBtn").onclick=()=>alert("Step 2 will restore equip from owned weapons.");
$("refreshWeaponBtn").onclick=()=>alert("Step 2 will restore weapon refresh.");
$("buyRelicBtn").onclick=()=>alert("Step 2 will restore full Relic Shop list + buy/equip.");
$("equipRelicBtn").onclick=()=>alert("Step 2 will restore equip from owned relics.");
$("refreshRelicBtn").onclick=()=>alert("Step 2 will restore relic refresh.");

/* Save / reset */
$("saveBtn").onclick=()=>{ persist(); refreshTop(); };
$("resetBtn").onclick=()=>{ localStorage.removeItem(SAVE_KEY); state=defaultState(); persist(); refreshTop(); refreshDojo(); };

/* Meditation placeholder */
$("dailyBtn").onclick=()=>alert("Step 2 wires 30-min TP meditation reward.");

persist();
refreshTop();
refreshDojo();
</script>
</body>
</html>
